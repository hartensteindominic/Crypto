<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SENTIENT.19 | Neural Assets</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.7.0/ethers.umd.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@100;400;900&display=swap');
        
        :root { --neon-blue: #3b82f6; }
        body { background: #050505; color: #fff; font-family: 'Outfit', sans-serif; overflow: hidden; height: 100vh; }
        
        .glass-ui { background: rgba(255,255,255,0.02); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.08); }
        
        .agent-node { width: 80px; height: 80px; border-radius: 50%; background: var(--neon-blue); filter: blur(25px); animation: pulse 2s infinite; }
        
        @keyframes pulse { 
            0%, 100% { opacity: 0.4; transform: scale(1); box-shadow: 0 0 20px var(--neon-blue); } 
            50% { opacity: 0.9; transform: scale(1.1); box-shadow: 0 0 50px var(--neon-blue); } 
        }

        .scanline {
            width: 100%; height: 2px; background: var(--neon-blue); opacity: 0.3;
            position: absolute; top: 0; left: 0; pointer-events: none;
            animation: scan 3s linear infinite;
        }

        @keyframes scan { 0% { top: 0%; } 100% { top: 100%; } }

        .nft-card { position: relative; overflow: hidden; transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .nft-card:hover { border-color: var(--neon-blue); transform: translateY(-5px); box-shadow: 0 0 30px rgba(59, 130, 246, 0.2); }
        
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 10px; }
    </style>
</head>
<body class="flex flex-col p-6">

    <header class="flex justify-between items-center mb-8 px-4">
        <div>
            <h1 class="text-3xl font-black italic tracking-tighter text-white">SENTIENT.19</h1>
            <p id="chain-status" class="text-[10px] text-zinc-500 uppercase tracking-widest mt-1">System: Standby</p>
        </div>
        <button id="connect-trigger" onclick="initWeb3()" class="bg-blue-600 hover:bg-white hover:text-black transition-all px-8 py-3 rounded-full text-xs font-black tracking-widest border border-blue-500/50">
            INITIALIZE LINK
        </button>
    </header>

    <main class="flex-grow grid grid-cols-12 gap-8 overflow-hidden">
        <aside class="col-span-4 glass-ui rounded-[3rem] p-8 flex flex-col items-center relative">
            <div class="agent-node mb-8"></div>
            <div id="ai-speech" class="text-lg font-light text-center italic text-blue-200 mb-8 leading-relaxed">
                "Neural authorization required. Align your wallet with the Base frequency."
            </div>
            
            <div id="inventory-panel" class="w-full mt-auto space-y-4 opacity-10 transition-opacity duration-700">
                <p class="text-[10px] font-bold text-zinc-400 border-b border-white/10 pb-2">LOCAL NEURAL VAULT</p>
                <div id="user-nfts" class="grid grid-cols-4 gap-2 min-h-[60px]">
                    </div>
                <div class="flex justify-between text-[10px] font-mono text-zinc-500">
                    <span>VAULT_ID:</span>
                    <span id="display-address" class="text-blue-400">UNLINKED</span>
                </div>
            </div>
        </aside>

        <section class="col-span-8 glass-ui rounded-[3rem] p-10 overflow-y-auto relative">
            <div id="market-display" class="grid grid-cols-2 gap-8 opacity-20 pointer-events-none transition-all duration-1000">
                </div>
        </section>
    </main>

    <script>
        let provider, signer, userAddress;
        const BASE_HEX = "0x2105"; // 8453 for Base Mainnet
        const TREASURY = "0x02f93c7547309ca50EEAB446DaEBE8ce8E694cBb";

        function aiSpeak(text) {
            window.speechSynthesis.cancel();
            const msg = new SpeechSynthesisUtterance(text);
            msg.rate = 1.1;
            msg.pitch = 0.8; // Lower pitch for "sentient" feel
            window.speechSynthesis.speak(msg);
            document.getElementById('ai-speech').innerText = `"${text}"`;
        }

        async function initWeb3() {
            if (!window.ethereum) return aiSpeak("No neural interface found. Please install a Web3 wallet.");
            
            try {
                provider = new ethers.BrowserProvider(window.ethereum);
                
                // Attempt Network Switch/Add
                try {
                    await window.ethereum.request({
                        method: 'wallet_switchEthereumChain',
                        params: [{ chainId: BASE_HEX }],
                    });
                } catch (err) {
                    if (err.code === 4902) {
                        await window.ethereum.request({
                            method: 'wallet_addEthereumChain',
                            params: [{
                                chainId: BASE_HEX,
                                chainName: 'Base',
                                nativeCurrency: { name: 'ETH', symbol: 'ETH', decimals: 18 },
                                rpcUrls: ['https://mainnet.base.org'],
                                blockExplorerUrls: ['https://basescan.org']
                            }]
                        });
                    }
                }

                signer = await provider.getSigner();
                userAddress = await signer.getAddress();
                
                updateUI(userAddress);
                aiSpeak("Neural link established. Accessing the decentralized asset pool.");
                loadMarket();

            } catch (err) {
                console.error(err);
                aiSpeak("Connection aborted. Re-authenticate to proceed.");
            }
        }

        function updateUI(addr) {
            document.getElementById('connect-trigger').innerText = addr.slice(0,6) + "..." + addr.slice(-4);
            document.getElementById('chain-status').innerText = "Status: Linked to Base L2";
            document.getElementById('display-address').innerText = addr.slice(0,10);
            document.getElementById('market-display').classList.remove('opacity-20', 'pointer-events-none');
            document.getElementById('inventory-panel').classList.remove('opacity-10');
        }

        function loadMarket() {
            const assets = [
                {id: 102, name: "GHOST_SHELL", price: "0.0001"},
                {id: 404, name: "VOID_CORE", price: "0.0002"},
                {id: 777, name: "NEURAL_LINK", price: "0.00015"},
                {id: 999, name: "SYNTH_SOUL", price: "0.0003"}
            ];
            const display = document.getElementById('market-display');
            display.innerHTML = assets.map(asset => `
                <div class="nft-card bg-black/40 border border-white/5 p-6 rounded-[2.5rem]">
                    <div class="scanline"></div>
                    <img src="https://picsum.photos/seed/${asset.id}/400/400" class="rounded-3xl mb-4 grayscale hover:grayscale-0 transition-all duration-500">
                    <div class="flex justify-between items-center">
                        <div>
                            <p class="text-[10px] text-blue-400 font-mono font-bold tracking-widest">${asset.name}</p>
                            <p class="text-sm font-black">${asset.price} ETH</p>
                        </div>
                        <button onclick="acquireAsset('${asset.id}', '${asset.price}', '${asset.name}')" 
                                class="bg-blue-600 px-6 py-2 rounded-full font-black text-[10px] hover:bg-white hover:text-black transition-all">
                            ACQUIRE
                        </button>
                    </div>
                </div>
            `).join('');
        }

        async function acquireAsset(id, price, name) {
            if(!signer) return;
            aiSpeak(`Initiating transfer for ${name}. Verify the gas fees.`);

            try {
                const tx = await signer.sendTransaction({
                    to: TREASURY,
                    value: ethers.parseEther(price)
                });
                
                aiSpeak("Transaction broadcasted. Awaiting block confirmation.");
                await tx.wait();

                depositToInventory(id);
                aiSpeak(`Authorization complete. ${name} is now part of your neural inventory.`);
            } catch (err) {
                aiSpeak("Neural link interrupted. Transaction failed.");
            }
        }

        function depositToInventory(id) {
            const inv = document.getElementById('user-nfts');
            const img = document.createElement('img');
            img.src = `https://picsum.photos/seed/${id}/100/100`;
            img.className = "w-full aspect-square rounded-xl border border-blue-500/40 animate-pulse transition-all hover:scale-110 cursor-crosshair";
            inv.prepend(img);
        }
    </script>
</body>
</html>
