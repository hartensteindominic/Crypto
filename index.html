<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ARTPOOL | Agentic Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.7.0/ethers.umd.min.js"></script>
    <style>
        body { background: #020202; color: #fff; font-family: 'Outfit', sans-serif; overflow: hidden; }
        .agent-core { width: 120px; height: 120px; border-radius: 50%; background: radial-gradient(circle, #3b82f6, transparent); filter: blur(30px); transition: 0.5s; }
        .glass { background: rgba(255,255,255,0.02); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.05); }
        .active-ring { border: 2px solid #3b82f6; box-shadow: 0 0 20px rgba(59, 130, 246, 0.4); }
        ::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="h-screen flex">

    <aside class="w-96 glass border-r border-white/5 flex flex-col p-8 z-50">
        <div class="mb-10">
            <h1 class="text-2xl font-black italic tracking-tighter">SENTIENT.18</h1>
            <p id="status" class="text-[10px] text-zinc-500 font-mono uppercase mt-1">Awaiting Neural Link</p>
        </div>

        <div class="flex-grow flex flex-col items-center justify-center gap-6">
            <div id="ai-orb" class="agent-core opacity-50"></div>
            <div id="speech-bubble" class="text-center text-sm italic text-blue-300 leading-relaxed min-h-[60px]">
                "Hello. I am your agent. Connect your wallet to begin."
            </div>
            <button onclick="connectWeb3()" id="connect-btn" class="w-full py-4 bg-blue-600 rounded-2xl font-black text-xs hover:bg-white hover:text-black transition-all">
                LINK WALLET: 0x02f9...
            </button>
        </div>

        <div class="mt-8 p-4 glass rounded-2xl text-[10px] font-mono text-zinc-500">
            <div>NETWORK: BASE L2</div>
            <div>FEE RECIPIENT: 0x02f9...CBB</div>
        </div>
    </aside>

    <main class="flex-grow flex flex-col">
        <header class="p-8 flex justify-between items-center">
            <div class="flex gap-8 text-xs font-bold uppercase">
                <button onclick="switchView('market')" class="text-blue-500 border-b-2 border-blue-500 pb-2">Market</button>
                <button onclick="switchView('vault')" class="text-zinc-500 hover:text-white transition">My Account</button>
            </div>
            <div id="wallet-tag" class="text-[10px] font-mono opacity-0">...</div>
        </header>

        <section id="content-grid" class="p-10 grid grid-cols-2 lg:grid-cols-3 gap-8 overflow-y-auto">
            </section>
    </main>

    <script>
        let provider, signer, userAddress;
        let myCollection = [];
        const orb = document.getElementById('ai-orb');
        const speech = document.getElementById('speech-bubble');
        const status = document.getElementById('status');
        const grid = document.getElementById('content-grid');

        // --- THE VOICE OF THE AGENT ---
        function aiTalk(text) {
            window.speechSynthesis.cancel();
            const msg = new SpeechSynthesisUtterance(text);
            msg.rate = 0.9;
            window.speechSynthesis.speak(msg);
            speech.innerText = `"${text}"`;
        }

        // --- WEB3 CONNECTION ---
        async function connectWeb3() {
            if (window.ethereum) {
                try {
                    provider = new ethers.BrowserProvider(window.ethereum);
                    signer = await provider.getSigner();
                    userAddress = await signer.getAddress();
                    
                    document.getElementById('connect-btn').innerText = "LINKED & SECURE";
                    document.getElementById('wallet-tag').innerText = userAddress;
                    document.getElementById('wallet-tag').style.opacity = 1;
                    
                    orb.classList.replace('opacity-50', 'active-ring');
                    status.innerText = "Neural Link Active";
                    aiTalk("Neural handshake complete. I have identified your wallet on the Base network. I am now authorized to route fees to your account and manage your vault.");
                    
                    renderMarket();
                } catch (err) {
                    aiTalk("The neural link was rejected. Please authorize your wallet.");
                }
            } else {
                aiTalk("I cannot find a wallet extension. Please install Metamask or Coinbase Wallet.");
            }
        }

        // --- AGENTIC MARKETPLACE ---
        function renderMarket() {
            grid.innerHTML = '';
            for(let i=0; i<6; i++) {
                const id = Math.floor(Math.random()*1000);
                const item = document.createElement('div');
                item.className = "glass p-6 rounded-[2.5rem] hover:scale-105 transition-all cursor-pointer border border-white/5";
                item.innerHTML = `
                    <img src="https://picsum.photos/seed/${id}/400/400" class="rounded-3xl mb-4 grayscale hover:grayscale-0 transition-all">
                    <div class="flex justify-between items-center">
                        <div>
                            <p class="text-[10px] text-zinc-500 font-mono">ASSET_${id}</p>
                            <p class="text-sm font-bold">0.05 ETH</p>
                        </div>
                        <button onclick="buyArt(${id})" class="bg-blue-600 px-6 py-2 rounded-full font-black text-[10px]">BUY</button>
                    </div>
                `;
                grid.appendChild(item);
            }
        }

        async function buyArt(id) {
            if(!userAddress) return aiTalk("Connect your wallet first.");
            
            aiTalk(`Preparing smart contract interaction for Asset ${id}. I am calculating the split. Zero point zero five E T H confirmed. The protocol reward will be routed back to your 0x02f9 account.`);
            
            // Logic to simulate on-chain movement
            setTimeout(() => {
                myCollection.push(id);
                aiTalk("Success. The transaction is mined. I have moved the artwork into your account vault.");
                switchView('vault');
            }, 3000);
        }

        function switchView(view) {
            grid.innerHTML = '';
            if(view === 'vault') {
                if(myCollection.length === 0) {
                    grid.innerHTML = '<div class="col-span-3 text-center py-20 text-zinc-600">Your account vault is empty.</div>';
                } else {
                    myCollection.forEach(id => {
                        const div = document.createElement('div');
                        div.className = "glass p-6 rounded-[2.5rem]";
                        div.innerHTML = `<img src="https://picsum.photos/seed/${id}/400/400" class="rounded-3xl mb-2"><p class="text-xs font-bold">Vaulted Asset #${id}</p>`;
                        grid.appendChild(div);
                    });
                }
            } else {
                renderMarket();
            }
        }
    </script>
</body>
</html>
