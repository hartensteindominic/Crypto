<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>WiFi Rocket Mission Control</title>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <style>
    :root { --neon: #00d4ff; --glow: #ff6600; --dark: #0a001a; }
    body {
      margin: 0; min-height: 100vh; background: radial-gradient(circle at top, #1a0033 0%, #000 100%);
      color: white; font-family: 'Courier New', monospace; display: flex; justify-content: center; align-items: center;
      overflow-x: hidden; -webkit-overflow-scrolling: touch;
    }
    .dashboard {
      position: relative; z-index: 10; background: rgba(10,10,35,0.92); border: 2px solid var(--neon); border-radius: 25px;
      width: 90%; max-width: 420px; margin: 40px auto; padding: 35px 20px; text-align: center;
      box-shadow: 0 0 40px rgba(0,212,255,0.3); backdrop-filter: blur(12px);
    }
    .rev-header {
      background: rgba(0,212,255,0.12); border-radius: 15px; padding: 20px; margin-bottom: 25px; border: 1px solid var(--neon);
    }
    #revenue { color: #00ff88; font-size: 36px; font-weight: bold; text-shadow: 0 0 20px #00ff88; }
    input {
      width: 100%; padding: 15px; margin: 15px 0; border-radius: 12px; border: 1px solid #333; background: #000; color: var(--neon);
      text-align: center; font-size: 20px;
    }
    button {
      background: linear-gradient(135deg, var(--glow), #ff2200); color: white; border: none; padding: 18px; width: 100%; border-radius: 12px;
      font-weight: bold; font-size: 18px; cursor: pointer; box-shadow: 0 5px 15px rgba(255,102,0,0.4); transition: 0.3s;
      margin: 10px 0;
    }
    button:hover:not(:disabled) { transform: translateY(-3px); box-shadow: 0 8px 25px rgba(255,102,0,0.6); }
    button:disabled { opacity: 0.6; cursor: not-allowed; }
    #rocket-nft { font-size: 130px; margin: 30px 0; filter: drop-shadow(0 0 30px var(--glow)); animation: vibrate 0.12s infinite alternate; }
    @keyframes vibrate { from { transform: translate(1.5px,1.5px); } to { transform: translate(-1.5px,-1.5px); } }
    .progress-container { width: 100%; background: #111; border-radius: 10px; height: 18px; margin: 25px 0; overflow: hidden; border: 1px solid #222; }
    #progress-fill { width: 0%; height: 100%; background: linear-gradient(90deg, var(--neon), #00ff88); box-shadow: 0 0 20px var(--neon); transition: width 0.3s ease; }
    .hidden { display: none; }
    .spinner { border: 5px solid #333; border-top: 5px solid var(--neon); border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 20px auto; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    .success { color: #00ff88; text-shadow: 0 0 20px #00ff88; }
    .warning { background: rgba(255,69,0,0.18); border: 1px solid #ff4500; border-radius: 12px; padding: 15px; margin: 20px 0; color: #ffaa00; font-size: 14px; line-height: 1.4; }
  </style>
</head>
<body>

<div class="dashboard">
  <div class="warning text-center">
    <strong>‚ö†Ô∏è Important:</strong> This is a tip/demo page.<br>
    ETH/USDC sent/swapped goes directly to the creator.<br>
    Swap uses Uniswap v3 (real on-chain). No staking/NFT yet.
  </div>

  <div class="rev-header">
    <small style="letter-spacing: 2px; color: #88aaff;">WIFI DATA REVENUE</small><br>
    <span id="revenue">$0.00</span>
  </div>

  <!-- Start UI -->
  <div id="ui-start">
    <h2>Mission Fuel</h2>
    <p style="font-size: 14px; color: #88aaff;">Send ETH (tip) or swap to USDC to fuel the mission</p>

    <input type="number" id="ethAmount" value="0.001" step="0.001" min="0.001" max="0.1" placeholder="0.001 ‚Äì 0.1 ETH">

    <button id="sendBtn">SEND ETH (Tip)</button>
    <button id="swapBtn">SWAP ETH ‚Üí USDC</button>

    <!-- Temporary test button to force rocket -->
    <button onclick="showSuccess()" style="background:#006600; margin-top:15px;">TEST ROCKET (demo)</button>
  </div>

  <!-- Processing UI -->
  <div id="ui-processing" class="hidden">
    <h3>PROCESSING TRANSACTION</h3>
    <div class="progress-container"><div id="progress-fill"></div></div>
    <p id="status-log" style="font-size: 13px; color: var(--neon);">Executing on-chain...</p>
    <div class="spinner"></div>
  </div>

  <!-- Success UI -->
  <div id="ui-success" class="hidden">
    <div id="rocket-nft">üöÄ</div>
    <h2 class="success">MISSION LIVE!</h2>
    <p>Transaction confirmed. Revenue is flowing.</p>
    <button onclick="location.reload()" style="background:#1a1a2e; border:1px solid #333; margin-top:20px;">NEW MISSION</button>
  </div>
</div>

<script>
let totalRev = 0;
const RECIPIENT = "0x02F949281A8c9837963C82813589B845C5194Cbb";
const USDC = "0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48";
const UNISWAP_ROUTER = "0xE592427A0AEce92De3Edee1F18E0157C05861564";

async function sendETH() {
  if (!window.ethereum) return alert("Open in MetaMask!");

  const provider = new ethers.providers.Web3Provider(window.ethereum);
  const signer = provider.getSigner();

  try {
    await provider.send("eth_requestAccounts", []);
    const amountStr = document.getElementById('ethAmount').value;
    if (!amountStr || parseFloat(amountStr) < 0.001) return alert("Minimum 0.001 ETH");

    const amount = ethers.utils.parseEther(amountStr);

    document.getElementById('ui-start').classList.add('hidden');
    document.getElementById('ui-processing').classList.remove('hidden');

    simulateWiFi();

    const tx = await signer.sendTransaction({
      to: RECIPIENT,
      value: amount
    });

    await tx.wait();
    showSuccess();

  } catch (e) {
    alert("Failed: " + (e.message || e));
    location.reload();
  }
}

async function swapETHtoUSDC() {
  if (!window.ethereum) return alert("Open in MetaMask!");

  const provider = new ethers.providers.Web3Provider(window.ethereum);
  const signer = provider.getSigner();

  try {
    await provider.send("eth_requestAccounts", []);
    const amountStr = document.getElementById('ethAmount').value;
    if (!amountStr || parseFloat(amountStr) < 0.001) return alert("Minimum 0.001 ETH");

    const amountIn = ethers.utils.parseEther(amountStr);

    document.getElementById('ui-start').classList.add('hidden');
    document.getElementById('ui-processing').classList.remove('hidden');

    simulateWiFi();

    const router = new ethers.Contract(UNISWAP_ROUTER, [
      "function exactInputSingle(tuple(address tokenIn, address tokenOut, uint24 fee, address recipient, uint256 deadline, uint256 amountIn, uint256 amountOutMinimum, uint160 sqrtPriceLimitX96)) external payable returns (uint256 amountOut)"
    ], signer);

    const params = {
      tokenIn: ethers.constants.AddressZero,
      tokenOut: USDC,
      fee: 3000,
      recipient: await signer.getAddress(),
      deadline: Math.floor(Date.now() / 1000) + 60 * 20,
      amountIn: amountIn,
      amountOutMinimum: 0,
      sqrtPriceLimitX96: 0
    };

    const tx = await router.exactInputSingle(params, { value: amountIn });
    await tx.wait();

    showSuccess();

  } catch (e) {
    alert("Swap failed: " + (e.message || e));
    location.reload();
  }
}

function simulateWiFi() {
  let progress = 0;
  const fill = document.getElementById('progress-fill');
  const log = document.getElementById('status-log');
  const rev = document.getElementById('revenue');

  const interval = setInterval(() => {
    progress += Math.random() * 5 + 2;
    if (progress > 100) progress = 100;
    totalRev += Math.random() * 1.2;
    fill.style.width = progress + "%";
    rev.innerText = "$" + totalRev.toFixed(2);
    log.innerText = `Processing: ${(progress * 150).toFixed(0)} kbps`;

    if (progress >= 100) clearInterval(interval);
  }, 160);
}

function showSuccess() {
  document.getElementById('ui-processing').classList.add('hidden');
  document.getElementById('ui-success').classList.remove('hidden');

  setInterval(() => {
    totalRev += Math.random() * 0.4;
    document.getElementById('revenue').innerText = "$" + totalRev.toFixed(2);
  }, 1800);
}

document.getElementById('sendBtn').onclick = sendETH;
document.getElementById('swapBtn').onclick = swapETHtoUSDC;
</script>
</body>
</html>e
