<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TITAN // MOBILE_PAYOUT</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.7.0/ethers.umd.min.js"></script>
    <style>
        body { background: #050505; color: #e2e2e2; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; }
        .neon-border { border: 1px solid rgba(34, 211, 238, 0.3); box-shadow: 0 0 15px rgba(34, 211, 238, 0.1); }
        .btn-gold { background: #d4af37; color: #000; font-weight: 900; transition: 0.2s; }
        .btn-gold:active { transform: scale(0.95); opacity: 0.8; }
    </style>
</head>
<body class="p-4 flex flex-col items-center min-h-screen">

    <div class="w-full max-w-md p-8 mt-10 rounded-3xl neon-border bg-black text-center">
        <p class="text-[10px] tracking-[0.3em] text-cyan-400 mb-2 uppercase font-bold">Protocol_Earnings</p>
        <h1 id="points-display" class="text-6xl font-black text-white italic mb-1">0.00</h1>
        <p id="usd-display" class="text-xs text-gray-500 mb-8 font-bold">$0.00 USD</p>
        
        <button onclick="handleWithdrawal()" class="btn-gold w-full py-4 rounded-xl uppercase text-xs tracking-widest">
            Withdraw to Wallet
        </button>
    </div>

    <div class="w-full max-w-md p-6 mt-6 rounded-3xl bg-white/5 border border-white/10">
        <h2 class="text-[10px] text-gray-400 mb-4 uppercase font-bold">Submit_Asset_for_Yield</h2>
        <textarea id="asset-desc" placeholder="Describe your digital product..." class="w-full bg-black border border-white/20 p-4 rounded-xl text-sm mb-4 h-24 outline-none focus:border-cyan-500"></textarea>
        
        <label class="block w-full py-4 bg-cyan-900/20 border border-cyan-500/40 rounded-xl text-center cursor-pointer">
            <span id="upload-text" class="text-[10px] text-cyan-400 font-black">UPLOAD & VALUATE</span>
            <input type="file" class="hidden" onchange="simulateValuation()">
        </label>
    </div>

    <script>
        let points = parseFloat(localStorage.getItem('titan_v89_points')) || 0;
        const RATE = 0.00001; // Points to ETH

        function updateUI() {
            document.getElementById('points-display').innerText = points.toFixed(2);
            document.getElementById('usd-display').innerText = `$${(points * RATE * 2350).toFixed(2)} USD`;
        }
        updateUI();

        function simulateValuation() {
            const desc = document.getElementById('asset-desc').value;
            if(!desc) return alert("Enter a description first.");
            
            document.getElementById('upload-text').innerText = "AI_ANALYZING...";
            setTimeout(() => {
                const gain = Math.floor(Math.random() * 400) + 100;
                points += gain;
                localStorage.setItem('titan_v89_points', points);
                updateUI();
                document.getElementById('upload-text').innerText = "UPLOAD & VALUATE";
                document.getElementById('asset-desc').value = "";
                alert(`ðŸ”± ASSET ACCEPTED\nValue: +${gain} Points`);
            }, 2000);
        }

        async function handleWithdrawal() {
            if (!window.ethereum) return alert("Open this link inside MetaMask Browser!");

            try {
                const provider = new ethers.BrowserProvider(window.ethereum);
                const signer = await provider.getSigner();
                const address = await signer.getAddress();
                const ethAmount = (points * RATE).toFixed(6);

                if (ethAmount < 0.001) return alert("Minimum 0.001 ETH required to cover network gas.");

                // ðŸ”± DIRECT SETTLEMENT
                const tx = await signer.sendTransaction({
                    to: address, 
                    value: ethers.parseEther(ethAmount)
                });

                alert("ðŸ”± TRANSACTION SIGNED\nWaiting for blockchain confirmation...");
                await tx.wait();

                points = 0;
                localStorage.setItem('titan_v89_points', 0);
                updateUI();
                alert("ðŸ”± SUCCESS\nETH has been settled in your wallet.");
            } catch (err) {
                console.error(err);
                alert("ðŸ”± REVERTED\nPossible causes: Insufficient balance for gas or rejected signature.");
            }
        }
    </script>
</body>
</html>
