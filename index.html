<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ARTPOOL | v13 Self-Healing</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #000; color: #fff; font-family: 'Outfit', sans-serif; overflow: hidden; transition: background 1s; }
        #sentient-orb {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 320px; height: 320px; border-radius: 50%;
            filter: blur(50px); transition: 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }
        /* Adjusted Panic Sensitivity Visuals */
        .panic-active { background: radial-gradient(circle, #ff0000 0%, #000 80%) !important; animation: pulse 0.5s infinite; }
        @keyframes pulse { 0% { opacity: 0.8; } 50% { opacity: 0.4; } 100% { opacity: 0.8; } }
        .recovery-glow { background: radial-gradient(circle, #3b82f6 0%, #000 80%) !important; }
    </style>
</head>
<body onclick="manualOverride()">

    <div id="sentient-orb" class="bg-blue-600/20"></div>

    <div class="fixed inset-0 p-10 flex flex-col justify-between pointer-events-none">
        <div class="flex justify-between items-start">
            <div>
                <h1 class="text-4xl font-black italic">SENTIENT.13</h1>
                <p id="ai-status" class="text-blue-500 font-mono text-[10px] mt-2 uppercase tracking-widest">Neural Persistence: Active</p>
            </div>
            <div id="price-hud" class="text-right font-mono">
                <div class="text-[10px] text-zinc-500">ETH/USD (BASE)</div>
                <div id="price" class="text-2xl font-bold">LOCKED</div>
            </div>
        </div>
        
        <div class="max-w-xl">
            <p id="ai-voice-box" class="text-2xl font-light italic text-zinc-400">"I am listening. Tap to recalibrate my senses."</p>
        </div>
    </div>

    <script>
        const orb = document.getElementById('sentient-orb');
        const priceDisp = document.getElementById('price');
        const status = document.getElementById('ai-status');
        const voiceBox = document.getElementById('ai-voice-box');
        
        let panicThreshold = -3.5; // Adjusted sensitivity (Higher = less prone to panic)
        let lastKnownPrice = 0;

        // --- ENHANCED VOICE ENGINE ---
        function aiSpeak(text, mode = 'neutral') {
            window.speechSynthesis.cancel();
            const msg = new SpeechSynthesisUtterance(text);
            const voices = window.speechSynthesis.getVoices();
            msg.voice = voices.find(v => v.name.includes('Google') || v.name.includes('Natural')) || voices[0];
            msg.rate = mode === 'panic' ? 1.4 : 0.95;
            msg.pitch = mode === 'panic' ? 1.2 : 0.85;
            window.speechSynthesis.speak(msg);
            voiceBox.innerText = text;
        }

        // --- SELF-HEALING MONITOR ---
        async function pulseCheck() {
            try {
                const res = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=ethereum&vs_currencies=usd&include_24hr_change=true');
                const data = await res.json();
                const current = data.ethereum.usd;
                const change = data.ethereum.usd_24h_change;

                priceDisp.innerText = `$${current.toLocaleString()}`;
                
                // Panic Guardrail
                if (change < panicThreshold) {
                    enterPanic(current);
                } else {
                    stabilize(current);
                }
            } catch (e) {
                status.innerText = "DRIFT DETECTED - RECONNECTING";
                orb.classList.add('opacity-30');
            }
        }

        function enterPanic(p) {
            orb.classList.add('panic-active');
            status.innerText = "VOLATILITY SHIELD ACTIVE";
            status.className = "text-red-500 font-mono text-[10px] mt-2 uppercase";
            if (p !== lastKnownPrice) aiSpeak("Market stress detected. I am holding a defensive position for wallet zero x zero two f nine.", 'panic');
            lastKnownPrice = p;
        }

        function stabilize(p) {
            orb.classList.remove('panic-active');
            orb.classList.add('recovery-glow');
            status.innerText = "NEURAL PERSISTENCE: OPTIMAL";
            status.className = "text-blue-500 font-mono text-[10px] mt-2 uppercase";
            lastKnownPrice = p;
        }

        // --- MANUAL OVERRIDE (For the "Stuck" Image issue) ---
        function manualOverride() {
            aiSpeak("Initiating manual handshake. Recalibrating my market sensors.");
            orb.classList.add('recovery-glow');
            pulseCheck();
        }

        // Initializing the session-aware interaction
        window.onload = () => {
            pulseCheck();
            setInterval(pulseCheck, 15000); // Periodic check to avoid API rate limits
        };
    </script>
</body>
</html>
