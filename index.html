<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Art Gallery</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.7.0/ethers.umd.min.js"></script>
    
    <style>
        body { font-family: sans-serif; background: #121212; color: white; text-align: center; padding: 50px; }
        .card { border: 1px solid #333; padding: 20px; border-radius: 15px; max-width: 300px; margin: 20px auto; background: #1a1a1a; }
        img { width: 100%; border-radius: 10px; }
        button { 
            background: #6200ee; color: white; border: none; padding: 12px 24px; 
            border-radius: 8px; cursor: pointer; font-weight: bold; margin-top: 10px;
        }
        button:hover { background: #3700b3; }
        #status { margin-top: 20px; color: #bb86fc; }
    </style>
</head>
<body>

    <h2>Digital Art Collection</h2>
    <button id="connectBtn">Connect Wallet</button>
    <p id="walletAddress"></p>

    <div class="card">
        <img src="https://via.placeholder.com/250" alt="Artwork">
        <h3>"Neon Genesis"</h3>
        <p>Price: 0.01 ETH</p>
        <button id="buyBtn">Buy Artwork</button>
    </div>

    <p id="status"></p>

    <script>
        const destinationAddress = "0x13B87B819252A81381C3Ce35e3Bd33199F4c6650";
        const itemPrice = "0.01"; // Price in ETH

        let signer;
        let provider;

        // --- Connect Wallet Function ---
        async function connectWallet() {
            if (window.ethereum) {
                try {
                    provider = new ethers.BrowserProvider(window.ethereum);
                    const accounts = await provider.send("eth_requestAccounts", []);
                    signer = await provider.getSigner();
                    
                    document.getElementById('walletAddress').innerText = `Connected: ${accounts[0].substring(0,6)}...${accounts[0].substring(38)}`;
                    document.getElementById('connectBtn').innerText = "Wallet Connected";
                } catch (error) {
                    console.error("User denied account access");
                }
            } else {
                alert("Please install a crypto wallet like MetaMask!");
            }
        }

        // --- Purchase Function ---
        async function buyArtwork() {
            if (!signer) {
                alert("Please connect your wallet first!");
                return;
            }

            try {
                document.getElementById('status').innerText = "Confirming transaction in your wallet...";
                
                // Sending the transaction
                const tx = await signer.sendTransaction({
                    to: destinationAddress,
                    value: ethers.parseEther(itemPrice)
                });

                document.getElementById('status').innerText = "Transaction sent! Waiting for confirmation...";
                
                // Wait for the transaction to be mined
                await tx.wait();
                
                document.getElementById('status').innerText = "Success! Artwork purchased.";
                alert("Payment received! Check the console for tx hash.");
                console.log("TX Hash:", tx.hash);

            } catch (error) {
                console.error(error);
                document.getElementById('status').innerText = "Transaction failed or cancelled.";
            }
        }

        // Event Listeners
        document.getElementById('connectBtn').addEventListener('click', connectWallet);
        document.getElementById('buyBtn').addEventListener('click', buyArtwork);
    </script>
</body>
</html>
